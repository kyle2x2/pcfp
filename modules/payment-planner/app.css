:root{
  --bg:#ffffff; --text:#0f172a; --muted:#64748b; --panel:#ffffff; --border:#e5e7eb; --chip:#f8fafc;
  --gold:#d4af37; --gold-d:#b8860b; --ok:#16a34a; --warn:#b7791f; --err:#dc2626;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.5 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial}
h1,h2,h3{margin:0}
a{color:#1d4ed8;text-decoration:none}
a:hover{text-decoration:underline}
header{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--border);background:#fff;position:relative}
.brand{display:flex;gap:10px;align-items:center}
.brand .badge{padding:7px 12px;border-radius:999px;background:var(--gold);color:#fff;font-weight:800;box-shadow:inset 0 -1px 0 rgba(0,0,0,.08)}
.brand h1{font-size:18px;font-weight:800;letter-spacing:.2px}
.container{padding:18px;max-width:1280px;margin:0 auto}
.card{background:var(--panel);border:1px solid var(--border);border-radius:14px;margin-bottom:16px;box-shadow:0 1px 0 rgba(15,23,42,.03)}
.card>h2{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--border);font-size:15px}
.section{padding:12px 14px}
.help{color:var(--muted);cursor:help;margin-left:6px}
.badges{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.badge-note{font-size:12px;border:1px solid var(--border);background:var(--chip);border-radius:999px;padding:4px 10px;color:#334155}
.controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
button{border:1px solid var(--gold-d);background:var(--gold);color:#111827;padding:8px 10px;border-radius:10px;cursor:pointer;font-weight:700;display:inline-flex;gap:6px;align-items:center;box-shadow:inset 0 -1px 0 rgba(0,0,0,.1)}
button svg{width:14px;height:14px}
button.ghost{background:#fff;border-color:var(--border);color:#0f172a}
button.ghost:hover{border-color:var(--gold-d);color:#b8860b}
input[type="number"],input[type="text"],input[type="date"],select,textarea{width:100%;padding:9px 10px;border:1px solid var(--border);border-radius:10px;background:#fff;color:#0f172a}
textarea{min-height:60px;resize:vertical}
label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
.grid{display:grid;gap:12px}
.cols-4{grid-template-columns:repeat(4,1fr)}
/* Tables */
.table{width:100%;border-collapse:separate;border-spacing:0}
.table thead th{background:linear-gradient(#fafafa,#f5f5f5);font-size:12px;color:#334155;border-bottom:1px solid var(--border)}
.table th,.table td{padding:8px 10px;border-bottom:1px solid var(--border);vertical-align:middle}
.num{text-align:right}
.table tfoot td{font-weight:800;background:#fafafa}
/* Column sizing via colgroup for exact alignment */
.cols-cash col.c1{width:24%} .cols-cash col.c2{width:14%} .cols-cash col.c3{width:12%} .cols-cash col.c4{width:12%} .cols-cash col.c5{width:14%} .cols-cash col.c6{width:12%} .cols-cash col.c7{width:12%}
.cols-scope col.c0{width:3%} .cols-scope col.c1{width:9%} .cols-scope col.c2{width:25%} .cols-scope col.c3{width:12%} .cols-scope col.c4{width:9%} .cols-scope col.c5{width:9%} .cols-scope col.c6{width:8%} .cols-scope col.c7{width:10%} .cols-scope col.c8{width:10%} .cols-scope col.c9{width:15%}
/* KPIs */
.kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.kpi{padding:14px;border:1px solid var(--border);border-radius:12px;background:#fff}
.kpi .label{font-size:12px;color:#64748b}
.kpi .val{font-weight:900;font-size:18px;margin-top:4px}
.track{height:10px;background:#f1f5f9;border:1px solid var(--border);border-radius:999px;overflow:hidden}
.track>div{height:100%;background:linear-gradient(90deg,rgba(212,175,55,.95),rgba(184,134,11,.85))}
/* Gantt */
.gantt{border:1px solid var(--border);border-radius:12px;overflow:auto;background:#fff}
.gantt-grid{display:grid;grid-template-columns:260px 1fr}
.gantt-left{padding:8px 12px}
.gantt-bars{position:relative;overflow:auto;border-left:1px solid var(--border)}
.time-row{display:grid;gap:6px;padding:10px 12px;border-bottom:1px solid var(--border);position:relative;background:#fff}
.time-row .pill{display:flex;align-items:center;justify-content:center;height:22px;border-radius:999px;background:#f3f4f6;border:1px solid #e5e7eb;font-size:12px;color:#374151}
.week-row .pill{height:20px}
.month-shade{position:absolute;top:0;bottom:0;background:#fafafa;opacity:.55;border-left:1px dashed #e5e7eb;border-right:1px dashed #e5e7eb}
.task-row{display:grid;grid-template-columns:260px 1fr;border-bottom:1px solid var(--border);align-items:center}
.task-bargrid{display:grid;gap:6px;padding:8px 12px;background:#fff}
.task-cell{height:16px;border-radius:8px;background:#f6f7f9;border:1px solid #edf2f7}
.task-cell.fill{background:linear-gradient(120deg,rgba(212,175,55,.6),rgba(184,134,11,.6))}
.task-row.active .task-cell.fill{outline:2px solid var(--gold-d)}
.owner-hide{display:initial}
.owner .owner-hide{display:none!important}
/* Toolbar */
.toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
/* Responsive */
@media (max-width:1024px){.container{max-width:100%}.cols-4{grid-template-columns:1fr}.kpis{grid-template-columns:1fr}.gantt-grid{grid-template-columns:200px 1fr}}
@media print{.no-print{display:none!important}}

/* === v5.1 additive CSS (safe) === */
:root{--gold:#D4AF37;--gold-dark:#B8860B}
.pcfp-menu{position:absolute;z-index:1000;background:#fff;border:1px solid #e5e7eb;border-radius:10px;box-shadow:0 8px 24px rgba(0,0,0,.08);min-width:170px;padding:6px}
.pcfp-menu button{width:100%;display:block;background:#fff;border:0;color:#0f172a;padding:8px 10px;text-align:left;border-radius:8px;cursor:pointer}
.pcfp-menu button:hover{background:#f8fafc}
.pcfp-menu-btn{border:1px solid #e5e7eb;background:#fff;border-radius:8px;padding:6px 10px;cursor:pointer}
#cashTable{table-layout:fixed}
#cashTable th,#cashTable td{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
#cashTable .num{text-align:right;font-variant-numeric:tabular-nums;font-feature-settings:'tnum' 1}
.btn.gold{background:var(--gold);border-color:var(--gold-dark);color:#111}
.gantt .bar{background:linear-gradient(90deg, rgba(212,175,55,.75), rgba(184,134,11,.7))}


/* v5.2.3 minimal, robust layout */
.summary-section{display:grid;grid-template-columns:1fr max-content;grid-auto-rows:auto;gap:14px}
.summary-section .kpis{grid-column:1 / -1;display:grid;grid-template-columns:repeat(3,minmax(220px,1fr));gap:12px}
.summary-section .deposit-block{grid-column:1}
.summary-section .controls{grid-column:2;display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end;align-items:center}
@media(max-width:960px){
  .summary-section{grid-template-columns:1fr}
  .summary-section .controls{justify-content:flex-start}
}

/* Cash table hardening without DOM moves */
#cashTable{table-layout:fixed;border-collapse:separate;border-spacing:0}
#cashTable th,#cashTable td{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;vertical-align:middle}
#cashTable .num{ text-align:right; font-variant-numeric: tabular-nums; font-feature-settings: 'tnum' 1 }


/* v5.2.4 Cash Table Hardening + Grid Ledger */
#cashTable{table-layout:fixed;border-collapse:separate;border-spacing:0}
#cashTable th,#cashTable td{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;vertical-align:middle;padding:10px 12px}
#cashTable .num{ text-align:right; font-variant-numeric: tabular-nums; font-feature-settings: 'tnum' 1 }

/* red banner used when schema issues detected */
#cashWarn{margin:6px 0 0 0; color:#b91c1c; font-size:13px; display:none}
#cashWarn.show{display:block}

/* Grid ledger alternative */
#cashGrid{display:grid; grid-auto-rows:auto; border:1px solid #e5e7eb; border-radius:10px; overflow:auto}
#cashGrid .gRow{display:contents}
#cashGrid .gCell{padding:10px 12px; border-bottom:1px solid #eef2f7; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
#cashGrid .gHead{background:#f8fafc; font-weight:600; border-bottom:1px solid #e5e7eb}
#cashGrid .num{ text-align:right; font-variant-numeric: tabular-nums; font-feature-settings: 'tnum' 1 }


/* v6.1.1 menu polish */
.pcfp-menu-btn{border:1px solid #e5e7eb;background:#fff;border-radius:8px;padding:6px 10px;cursor:pointer}
.pcfp-menu button{width:100%;display:block;background:#fff;border:0;color:#0f172a;padding:8px 10px;text-align:left;border-radius:8px;cursor:pointer}
.pcfp-menu button:hover{background:#f8fafc}


/* v6.2 schema guard banner */
.pcfp-banner{background:#fff7ed;border:1px solid #fed7aa;color:#7c2d12;padding:8px 12px;border-radius:10px;margin:10px 10px 0}


/* v6.3 shared menu button */
.pcfp-menu-btn{border:1px solid #e5e7eb;background:#fff;border-radius:8px;padding:6px 10px;cursor:pointer}
.c-menu button{width:100%;display:block;background:#fff;border:0;color:#0f172a;padding:8px 10px;text-align:left;border-radius:8px;cursor:pointer}
.c-menu button:hover{background:#f8fafc}


/* v6.3.1 align action cell */
#scopeTable tbody tr > td:last-child{ text-align:right; }

/* v7.1 compute toggle */
.calc{display:none}
.show-compute .calc{display:inline}
